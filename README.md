# 交通控制
***
## 运行环境
* HTML5
* JavaScript
* 支持HTML5的浏览器

## 实现功能
* 模拟十字路口的红绿灯运行情况
* 支持四种车辆，普通车辆和特殊车辆（警车、消防车、救护车），每种车辆的车速不同，保证特殊车辆比普通车辆快。
* 同种车辆按序行驶。
* 普通车辆不可超车，不可闯红灯。
* 特殊车辆可超车，表现为从被超的车辆上传过。
* 特殊车辆可闯红灯。
* 初始情况下，每一个车道上各有一种不同的车辆。
* 模拟过程中，可随时添加普通车辆或特殊车辆进行模拟（若车辆添加时会覆盖其他车辆时创建失败）。
* 模拟过程中，可随时暂停或恢复模拟。

## 图形界面实现
* 使用HTML5的canvas组件进行绘图操作。
* canvas刷新频率为10HZ。
* canvas刷新时计算红绿灯是否改变以及车辆的移动。
* 刷新时按如下顺序进行渲染绘图。

	> 1. clear() //清空画布
	> 2. drawLight() //绘制红绿灯
	> 3. drawRoad() //绘制道路
	> 4. drawCar() //绘制车辆

## 使用数据结构
* _light:存放红绿灯的信息
* _car:存放车辆信息
* _point:存放点的坐标
* _queue:循环队列

## 算法实现
* 车辆创建createCar

	> 1. 使用一个标记位判断车辆创建时是否会覆盖其他车辆。
	> 2. 根据车辆的类型赋给车辆不同的属性值。
	> 3. 将新建车辆根据类型添加到普通车辆队列或特殊车辆队列。
	> 4. 将标记位赋值为1

* 车辆移动检测checkMove

	> 1. 由于特殊车辆可超车可闯红灯，故不对其进行移动检测。
	> 2. 由于普通车辆按序前进，故先对待判断车辆所在队列的前一辆车进行碰撞检测。
	> 3. 判断当前方向的红绿灯状态以及车辆是否行驶到十字路口。
	> 4. 根据检测结果返回true或false。

* 车辆中止检测checkEnd

	> 1. 检测车辆是否驶出道路。
	> 2. 根据结果返回ture或false。

* 车辆移动move

	> 1. 先遍历特殊车辆队列，改变其坐标来模拟移动，并进行中止检测，如车辆驶出道路，将其移出队列。
	> 2. 遍历普通车辆队列，进行碰撞检测，如果不会碰撞前方车辆，改变横坐标模拟前进，并进行中止检测，如车辆驶出道路，将其移出队列。
	> 3. 遍历特殊车辆和普通车辆的队列尾部车辆，如果二者都驶出起始位置，设置标记位为0。

## 交互设计
* 使用三个按钮来实现“添加普通车辆”、“添加特殊车辆”、“开始模拟”和“暂停模拟”三种功能。
* 添加普通车辆createNormalCar

	> 1. 以上一次创建车辆所在的车道开始寻找可创建车辆的车道。

* 添加特殊车辆createExtraCar

	> 1. 以上次选择创建的特殊车辆类型开始创建下一种类型的特殊车辆。
	> 2. 以上一次创建车辆所在的车道开始寻找可创建车辆的车道。

* 开始模拟start

	> 1. 改变按钮的内容为“暂停模拟”。
	> 2. 改变按钮的点击事件为“pause”。
	> 3. 开启计时器

* 暂停模拟pause

	> 1. 改变按钮的内容为“开始模拟”。
	> 2. 改变按钮的点击事件为“start”。
	> 3. 关闭计时器
